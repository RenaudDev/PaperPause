# 1.E.5 — Nightwatcher Workflow Orchestration

Epic: `1 - PaperPause Autonomy System`  
**Status:** ✅ Complete

## Goal
Integrate the Scheduler and Conductor into the GitHub Actions lifecycle for 24/7 autonomous distribution with randomized timing.

## Scope

### Workflow 1: `daily-generate-and-optimize.yml` (Updated)
- [x] **Schedule:** `10 5 * * *` (12:10 AM ET / 05:10 UTC)
- [x] **New Steps in `commit` job:**
  - Download generation manifests from matrix jobs
  - Run Scheduler with `--from-manifests` flag
  - Commit distribution queue after content commit

### Workflow 2: `distribution-system.yml` (New)
- [x] **Schedule:** `*/15 6-22 * * *` (Every 15 min, 1 AM - 5 PM ET)
- [x] **Job: `distributor`**
  - Checkout repository
  - Install dependencies
  - Create `.dev.vars` with `MAKE_WEBHOOK` and `MAKE_WEBHOOK_API`
  - Run Conductor
  - Commit queue updates
- [x] **Permissions:** `contents: write`
- [x] **Manual trigger:** `workflow_dispatch`

## Timeline (Example Day)

| Time (UTC) | Time (ET) | Event |
| :--- | :--- | :--- |
| 05:10 | 12:10 AM | Generation workflow starts |
| ~05:30 | ~12:30 AM | Content committed, queue built with random times |
| 06:00 | 1:00 AM | First possible distribution slot |
| 06:00-21:00 | 1 AM - 4 PM | Conductor runs every 15 min, fires due items |

## Acceptance Criteria

- [x] Daily workflow runs at 12:10 AM ET
- [x] Scheduler runs after content commit, reads manifests
- [x] Distribution workflow runs every 15 minutes
- [x] Conductor correctly processes due items
- [x] Queue state is committed after each distribution
- [x] Manual dispatch works for testing

## Rollback
1. Revert `daily-generate-and-optimize.yml` to remove scheduler step
2. Delete `distribution-system.yml`
3. Revert scheduler/conductor scripts to previous versions
